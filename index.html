<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tuáº¥n â¤ï¸ Nga â€” Happy Birthday</title>
<style>
  :root{
    --pink:#ff6fcf;
    --violet:#b07bff;
    --glow: rgba(255,112,200,0.12);
  }
  html,body{height:100%;margin:0;background:#000;overflow:hidden;font-family:Inter, "Segoe UI", Roboto, Arial, sans-serif;}
  canvas{display:block; position:fixed; inset:0; z-index:1;}
  /* Trung tÃ¢m chá»¯ (hiá»ƒn thá»‹ trÃªn tim) */
  #centerText{position:fixed;left:50%;top:44%;transform:translate(-50%,-50%);z-index:8;text-align:center;color:#ffb6e0;pointer-events:none;}
  #centerText h1{margin:0;font-size:22px;letter-spacing:0.2px;text-shadow:0 6px 20px rgba(191,80,180,0.25);color: #ff8fcf;}
  #centerText p{margin:8px 0;font-size:16px;color:#ffcFEF;opacity:0.95;text-shadow:0 3px 12px rgba(120,30,80,0.12);}
  /* VÃ²ng chá»¯ xoay nhÆ° TikTok phÃ­a dÆ°á»›i (container xoay toÃ n bá»™) */
  .circle-wrap{position:fixed;left:50%;bottom:8vh;transform:translateX(-50%);width:min(760px,92vw);height:220px;pointer-events:none;z-index:7;perspective:1000px;overflow:visible;}
  .rotater{position:absolute;inset:0;transform-style:preserve-3d;transform-origin:center center;animation:spinText 3.5s linear infinite;will-change:transform;}
  @keyframes spinText { from{ transform:rotate(0deg);} to{ transform:rotate(360deg);} }
  .rotater span{
    position:absolute; left:50%; top:50%;
    transform-origin: 0 -260px; /* radius (khoáº£ng cÃ¡ch text -> tÃ¢m) */
    font-weight:600; color: #ff99cc; white-space:nowrap;
    text-shadow:0 2px 10px rgba(100,20,50,0.18); font-size:16px; letter-spacing:0.2px;
  }

  /* Nháº¡c button (náº¿u autoplay bá»‹ cháº·n) */
  #musicBtn{position:fixed;right:16px;bottom:16px;z-index:20;background:linear-gradient(135deg, rgba(255,110,180,0.14), rgba(140,50,210,0.06));border:1px solid rgba(255,255,255,0.06);padding:8px 12px;border-radius:10px;color:#fff;backdrop-filter: blur(6px);cursor:pointer}
  #musicBtn svg{vertical-align:middle;margin-right:6px}

  /* Nhá» gá»n cho Ä‘iá»‡n thoáº¡i */
  @media (max-width:520px){
    #centerText h1{font-size:18px}
    .rotater span{font-size:14px}
    .circle-wrap{height:160px}
  }
</style>
</head>
<body>

<canvas id="bg"></canvas>

<!-- Trung tÃ¢m ná»™i dung (giá»¯ nguyÃªn ná»™i dung lá»i chÃºc) -->
<div id="centerText" aria-hidden="true">
  <h1>Tuáº¥n â¤ï¸ Nga. Anh yÃªu em ğŸ’•ğŸ˜˜</h1>
  <p>BÃ© iuuu cá»§a anh thÃªm tuá»•i má»›i rá»“i, bá»›t bÆ°á»›ng 1 xÃ­u nha ğŸ˜†</p>
  <p>Gá»­i em 20/10 vui váº» ğŸ˜˜</p>
  <p>ChÃºc ngÆ°á»i con gÃ¡i anh yÃªu! KhÃ´ng chá»‰ hÃ´m nay, mÃ  táº¥t cáº£ 360 ngÃ y cÃ²n láº¡i Ä‘á»u vui váº», xinh Ä‘áº¹p em nhÃ© ğŸ«‚ğŸ’—</p>
  <p>ChÃºc em táº¥t cáº£ nhá»¯ng Ä‘iá»u tá»‘t Ä‘áº¹p nháº¥tğŸ’–</p>
  <p>ChÃºc em bÃ© cá»§a anh sáº½ tháº­t máº¡nh máº½ trÃªn con Ä‘Æ°á»ng phÃ­a trÆ°á»›c ğŸ’ªğŸŒ¸</p>
  <p>Sau nÃ y, em váº«n mÃ£i lÃ  má»™t pháº§n Ä‘áº·c biá»‡t trong tim anh â™¥ï¸ğŸ’—</p>
  <p>Cáº£m Æ¡n vÃ¬ hai ta Ä‘Ã£ gáº·p nhau á»Ÿ Ä‘á»™ tuá»•i Ä‘áº¹p nháº¥t ğŸ«‚ğŸ’•</p>
  <p style="font-weight:700;color:#ffd1e8">â™¥ï¸ YÃªu em â™¥ï¸</p>
</div>

<!-- VÃ²ng chá»¯ xoay (ná»™i dung tÃ¡ch thÃ nh nhiá»u Ä‘oáº¡n Ä‘á»ƒ Ä‘áº·t vÃ²ng) -->
<div class="circle-wrap" aria-hidden="true">
  <div class="rotater" id="rotater"></div>
</div>

<!-- Audio: thay AUDIO_SRC_HERE báº±ng link mp3 (Zing hoáº·c URL cÃ´ng khai) -->
<audio id="bgMusic" loop crossorigin="anonymous">
  <source src="AUDIO_SRC_HERE" type="audio/mpeg">
  <!-- Náº¿u khÃ´ng cÃ³ link, tá»‡p sáº½ khÃ´ng chÆ¡i; nÃºt báº­t nháº¡c dÃ¹ng Ä‘á»ƒ play -->
</audio>

<button id="musicBtn" title="Báº­t/Táº¯t nháº¡c" aria-label="Báº­t Táº¯t nháº¡c">
  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" style="filter: drop-shadow(0 2px 6px rgba(0,0,0,0.4));">
    <path d="M5 9v6h4l5 5V4L9 9H5z" fill="#ffd1e8"/>
  </svg>
  Báº­t/Táº¯t nháº¡c
</button>

<!-- Three.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
/* ========== helper: chá»¯ vÃ²ng quanh ========== */
const rotater = document.getElementById('rotater');
// Ná»™i dung xoay (mÃ¬nh ghÃ©p nhiá»u Ä‘oáº¡n, Ä‘á»ƒ chá»¯ hiá»‡n nhiá»u vÃ²ng)
const texts = [
  "Tuáº¥n â¤ï¸ Nga Â· Anh yÃªu em ğŸ’•ğŸ˜˜",
  "BÃ© iuuu cá»§a anh thÃªm tuá»•i má»›i rá»“i, bá»›t bÆ°á»›ng 1 xÃ­u nha ğŸ˜†",
  "Gá»­i em 20/10 vui váº» ğŸ˜˜",
  "ChÃºc ngÆ°á»i con gÃ¡i anh yÃªu! 360 ngÃ y cÃ²n láº¡i Ä‘á»u vui váº», xinh Ä‘áº¹p em nhÃ© ğŸ«‚ğŸ’—",
  "ChÃºc em táº¥t cáº£ nhá»¯ng Ä‘iá»u tá»‘t Ä‘áº¹p nháº¥tğŸ’–",
  "ChÃºc em bÃ© cá»§a anh sáº½ tháº­t máº¡nh máº½ trÃªn con Ä‘Æ°á»ng phÃ­a trÆ°á»›c ğŸ’ªğŸŒ¸",
  "Sau nÃ y, em váº«n mÃ£i lÃ  má»™t pháº§n Ä‘áº·c biá»‡t trong tim anh â™¥ï¸ğŸ’—",
  "Cáº£m Æ¡n vÃ¬ hai ta Ä‘Ã£ gáº·p nhau á»Ÿ Ä‘á»™ tuá»•i Ä‘áº¹p nháº¥t ğŸ«‚ğŸ’•",
  "â™¥ï¸ YÃªu em â™¥ï¸"
];
// Táº¡o ráº¥t nhiá»u span Ä‘á»ƒ vÃ²ng chá»¯ dÃ y nhÆ° TikTok
const RINGS = 3; // sá»‘ lá»›p vÃ²ng chá»¯
for(let ring=0; ring<RINGS; ring++){
  texts.forEach((txt,i)=>{
    const s = document.createElement('span');
    s.textContent = txt;
    // gÃ³c Ä‘áº·t: Ä‘á»u, cÃ³ offset theo vÃ²ng
    const angle = (i / texts.length) * 360 + ring * 20;
    s.style.transform = `rotate(${angle}deg) translateY(-${260 - ring*40}px) rotate(${-angle}deg)`;
    rotater.appendChild(s);
  });
}

/* ========== Three.js particle heart ========== */
const canvas = document.getElementById('bg');
const renderer = new THREE.WebGLRenderer({canvas, alpha:true, antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(window.devicePixelRatio ? window.devicePixelRatio : 1);

const scene = new THREE.Scene();
scene.background = new THREE.Color(0x000000);

const camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.z = 40;

// lights
const amb = new THREE.AmbientLight(0x202020);
scene.add(amb);
const pLight = new THREE.PointLight(0xff99d9, 1.2, 200);
pLight.position.set(30,30,50);
scene.add(pLight);

// create particle material (sprite-like)
const sprite = new THREE.TextureLoader().load('https://i.imgur.com/9yG6i7Q.png'); // small soft dot
const particlesMat = new THREE.PointsMaterial({
  size: 0.6,
  map: sprite,
  color: 0xffb3d9,
  transparent: true,
  blending: THREE.AdditiveBlending,
  depthWrite: false
});

// heart param -> returns Vector3
function heartFormula(t){
  // param t in [0, 2PI]
  const x = 16 * Math.pow(Math.sin(t), 3);
  const y = 13 * Math.cos(t) - 5*Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t);
  // scale down
  return new THREE.Vector3(x*0.9, y*0.9 - 5, (Math.cos(2*t) * 1.2));
}

// buffer geometry
const PARTICLE_COUNT = 1600;
const positions = new Float32Array(PARTICLE_COUNT * 3);
const basePositions = new Float32Array(PARTICLE_COUNT * 3);
const velocities = new Float32Array(PARTICLE_COUNT * 3); // dynamic velocities for explosion

// initialize positions around heart shape with jitter
for(let i=0;i<PARTICLE_COUNT;i++){
  const t = Math.random() * Math.PI * 2;
  const p = heartFormula(t);
  // jitter radial
  const jitter = (Math.random()-0.5) * 0.6;
  p.x += jitter * (Math.random() * 0.5);
  p.y += jitter * (Math.random() * 0.5);
  p.z += (Math.random()-0.5)*0.6;
  basePositions[i*3+0] = p.x;
  basePositions[i*3+1] = p.y;
  basePositions[i*3+2] = p.z;
  positions[i*3+0] = p.x + (Math.random()-0.5)*6; // start slightly dispersed
  positions[i*3+1] = p.y + (Math.random()-0.5)*6;
  positions[i*3+2] = p.z + (Math.random()-0.5)*6;
  velocities[i*3+0] = velocities[i*3+1] = velocities[i*3+2] = 0;
}

const geometry = new THREE.BufferGeometry();
geometry.setAttribute('position', new THREE.BufferAttribute(positions,3));
geometry.setAttribute('basePos', new THREE.BufferAttribute(basePositions,3));

const points = new THREE.Points(geometry, particlesMat);
scene.add(points);

// helper states
let exploded = false;
const explosionInterval = 5000; // 5s
let lastExplosion = 0;
let clock = new THREE.Clock();
let pulse = 0;

// explosion routine: give velocities outward
function explodeNow(){
  exploded = true;
  lastExplosion = performance.now();
  for(let i=0;i<PARTICLE_COUNT;i++){
    // direction from center to base pos
    const bx = basePositions[i*3+0];
    const by = basePositions[i*3+1];
    const bz = basePositions[i*3+2];
    // random outward velocity
    const vx = (bx + (Math.random()-0.5)) * (2 + Math.random()*3);
    const vy = (by + (Math.random()-0.5)) * (2 + Math.random()*3);
    const vz = (bz + (Math.random()-0.5)) * (2 + Math.random()*3);
    velocities[i*3+0] = vx * (0.9 + Math.random()*0.4);
    velocities[i*3+1] = vy * (0.9 + Math.random()*0.4) + 6 * (Math.random()*0.4); // give upward boost
    velocities[i*3+2] = vz * (0.9 + Math.random()*0.4);
  }
}

// animate loop
function animate(){
  requestAnimationFrame(animate);
  const elapsed = clock.getElapsedTime();
  // subtle pulse scale
  pulse = 1 + 0.06 * Math.sin(elapsed * 3);
  points.scale.set(pulse, pulse, pulse);

  const posAttr = geometry.attributes.position;
  for(let i=0;i<PARTICLE_COUNT;i++){
    const ix = i*3;
    // if exploded: particle moves by velocity with damping; else ease back to basePos
    if(exploded){
      // update pos by vel * dt
      positions[ix+0] += velocities[ix+0] * 0.02;
      positions[ix+1] += velocities[ix+1] * 0.02;
      positions[ix+2] += velocities[ix+2] * 0.02;
      // apply drag
      velocities[ix+0] *= 0.96;
      velocities[ix+1] *= 0.96;
      velocities[ix+2] *= 0.96;
      // slowly reduce alpha by moving back after 0.9s
      if(performance.now() - lastExplosion > 1200){
        // attract back
        positions[ix+0] += (basePositions[ix+0] - positions[ix+0]) * 0.02;
        positions[ix+1] += (basePositions[ix+1] - positions[ix+1]) * 0.02;
        positions[ix+2] += (basePositions[ix+2] - positions[ix+2]) * 0.02;
      }
    } else {
      // gently settle into base
      positions[ix+0] += (basePositions[ix+0] - positions[ix+0]) * 0.06;
      positions[ix+1] += (basePositions[ix+1] - positions[ix+1]) * 0.06;
      positions[ix+2] += (basePositions[ix+2] - positions[ix+2]) * 0.06;
    }
    // tiny random twinkle
    positions[ix+0] += (Math.random()-0.5) * 0.002;
    positions[ix+1] += (Math.random()-0.5) * 0.002;
  }
  // end explosion state after some time
  if(exploded && performance.now() - lastExplosion > 2000){
    exploded = false;
  }
  posAttr.needsUpdate = true;

  // rotate whole particle cloud slowly for 3D feel
  points.rotation.y += 0.006;
  points.rotation.x = Math.sin(elapsed*0.2) * 0.06;

  renderer.render(scene, camera);

  // trigger periodic explosions
  if(performance.now() - lastExplosion > explosionInterval){
    explodeNow();
  }
}
animate();

/* ========== resize handling ========== */
window.addEventListener('resize', () => {
  renderer.setSize(window.innerWidth, window.innerHeight);
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
});

/* ========== Music control ========== */
const music = document.getElementById('bgMusic');
const musicBtn = document.getElementById('musicBtn');

// try autoplay (may be blocked by browser)
function tryPlayMusic(){
  music.volume = 0.7;
  const p = music.play();
  if(p !== undefined){
    p.catch(()=>{ /* autoplay blocked */ });
  }
}

// add button toggling
let isPlaying = false;
musicBtn.addEventListener('click', ()=>{
  if(isPlaying){
    music.pause(); isPlaying = false; musicBtn.textContent = 'Báº­t/Táº¯t nháº¡c';
  } else {
    music.play().then(()=>{ isPlaying = true; musicBtn.textContent = 'Táº¯t nháº¡c'; }).catch(()=>{ isPlaying=false; });
  }
});

// auto attempt play on load
window.addEventListener('load', () => {
  tryPlayMusic();
  // detect if music actually playing after brief delay
  setTimeout(()=>{ if(!music.paused) { isPlaying=true; musicBtn.textContent='Táº¯t nháº¡c'; } }, 800);
});

/* ========== small depth glow overlay (CSS-like via canvas) ========== */
// create subtle pink-purple vignette by overlaying a transparent plane in three.js
const vignetteGeo = new THREE.PlaneGeometry(200,200);
const vignetteMat = new THREE.MeshBasicMaterial({
  map: null,
  transparent:true,
  opacity:0.25,
  depthWrite:false,
  blending:THREE.AdditiveBlending,
  color:0xff66cc
});
// we won't attach a texture now; leave subtle ambient color via fog-like ambient
scene.fog = new THREE.FogExp2(0x000000, 0.002);

</script>
</body>
</html>
